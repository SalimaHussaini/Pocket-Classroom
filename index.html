<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pocket Classroom</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="css/styles.css">
    <link href="asset/favicon.ico" rel="icon">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top">
        <div class="container">
            <a class="navbar-brand" href="#">
                <i class="fas fa-chalkboard-teacher me-2"></i>Pocket Classroom
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="#" data-view="library">
                            <i class="fas fa-book me-1"></i>Library
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-view="author">
                            <i class="fas fa-edit me-1"></i>Author
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-view="learn">
                            <i class="fas fa-graduation-cap me-1"></i>Learn
                        </a>
                    </li>
                </ul>
                <div class="d-flex">
                    <button class="btn btn-outline-light btn-sm me-2" id="themeToggle">
                        <i class="fas fa-moon"></i>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Library View -->
    <section id="library-view" class="container mt-4 view">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2>Your Capsules</h2>
            <div>
                <button class="btn btn-primary me-2" id="newCapsuleBtn">New Capsule</button>
                <button class="btn btn-primary" id="importBtn">Import JSON</button>
                <input type="file" id="importFile" accept=".json,application/json" style="display: none;">            </div>
        </div>
        
        <div id="capsulesGrid" class="row">
            <!-- Capsules will be populated here -->
        </div>
        
        <div id="emptyState" class="text-center py-5" style="display: none;">
            <h3 class="text-muted">No capsules yet</h3>
            <p class="text-muted">Create your first learning capsule to get started!</p>
            <button class="btn btn-primary" id="emptyNewCapsuleBtn">Create New Capsule</button>
        </div>
    </section>

    <!-- Author View -->
    <section id="author-view" class="container mt-4 view" style="display: none;">
        <h2>Author Capsule</h2>
        <p class="text-muted">Draft notes, flashcards and quizzes. Auto-saved locally.</p>
        
        <form id="capsuleForm">
            <!-- Meta Section -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0">Meta</h5>
                </div>
                <div class="card-body">
                    <div class="row g-3">
                        <div class="col-md-6">
                            <label for="title" class="form-label ">Title</label>
                            <input type="text" class="form-control" id="title" required>
                        </div>
                        <div class="col-md-6">
                            <label for="subject" class="form-label">Subject</label>
                            <input type="text" class="form-control" id="subject" required>
                        </div>
                        <div class="col-md-6">
                            <label for="level" class="form-label">Level</label>
                            <select class="form-select" id="level">
                                <option value="Beginner">Beginner</option>
                                <option value="Intermediate">Intermediate</option>
                                <option value="Advanced">Advanced</option>
                            </select>
                        </div>
                        <div class="col-12">
                            <label for="description" class="form-label">Description</label>
                            <textarea class="form-control" id="description" rows="2" placeholder="1-2 sentences about this capsule..."></textarea>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Notes Section -->
            <div class="card mb-4">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h5 class="mb-0">Notes</h5>
                </div>
                <div class="card-body">
                    <textarea class="form-control" id="notes" rows="6" placeholder="Enter your notes, one per line..."></textarea>
                </div>
            </div>

            <!-- Flashcards Section -->
            <div class="card mb-4">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h5 class="mb-0">Flashcards</h5>
                    <button type="button" class="btn btn-sm btn-outline-primary" id="addFlashcardBtn">Add Flashcard</button>
                </div>
                <div class="card-body">
                    <div id="flashcardsEditor">
                        <!-- Flashcard rows will be added here -->
                    </div>
                </div>
            </div>

            <!-- Quiz Section -->
            <div class="card mb-4">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h5 class="mb-0">Quiz</h5>
                    <button type="button" class="btn btn-sm btn-outline-primary" id="addQuestionBtn">Add Question</button>
                </div>
                <div class="card-body">
                    <div id="quizEditor">
                        <!-- Quiz questions will be added here -->
                    </div>
                </div>
            </div>

            <div class="d-flex gap-3 mb-4 "m>
                <button type="submit" class="btn btn-primary">Save Capsule</button>
                <button type="button" class="btn btn-outline-secondary" id="cancelEditBtn">Cancel</button>
            </div>
        </form>
    </section>

    <!-- Learn View -->
    <section id="learn-view" class="container mt-4 view" style="display: none;">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2>Learn</h2>
            <div class="d-flex gap-2">
                <select class="form-select" id="capsuleSelector" style="width: auto;">
                    <option value="">Select a capsule...</option>
                </select>
                <button class="btn btn-primary" id="exportCurrentBtn">Export</button>
            </div>
        </div>

        <div id="learnContent" style="display: none;">
            <!-- Capsule Meta -->
            <div class="card mb-4">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-start">
                        <div>
                            <h4 id="learnTitle" class="card-title"></h4>
                            <div class="d-flex gap-2 mt-2">
                                <span id="learnSubject" class="badge bg-secondary"></span>
                                <span id="learnLevel" class="badge bg-primary"></span>
                            </div>
                            <p id="learnDescription" class="card-text mt-2 text-muted"></p>
                        </div>
                        <div class="text-end ">
                            <div class="progress mb-2" style="width: 150px;">
                                <div id="quizProgressBar" class="progress-bar" role="progressbar" style="width: 0%"></div>
                            </div>
                            <small class="text-muted">Best Quiz Score</small>
                            <br>
                            <small class="text-muted" id="knownCardsCount">0 known cards</small>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tabs -->
            <ul class="nav nav-tabs mb-4" id="learnTabs" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="notes-tab" data-bs-toggle="tab" data-bs-target="#notes" type="button" role="tab">Notes</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="flashcards-tab" data-bs-toggle="tab" data-bs-target="#flashcards" type="button" role="tab">Flashcards</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="quiz-tab" data-bs-toggle="tab" data-bs-target="#quiz" type="button" role="tab">Quiz</button>
                </li>
            </ul>

            <div class="tab-content" id="learnTabContent">
                <!-- Notes Tab -->
                <div class="tab-pane fade show active" id="notes" role="tabpanel">
                    <div class="mb-4">
                        <input type="text" class="form-control" id="notesSearch" placeholder="Search notes...">
                    </div>
                    <ol class="list-group list-group-numbered mb-4" id="notesList">
                        <!-- Notes will be populated here -->
                    </ol>
                </div>

                <!-- Flashcards Tab -->
                <div class="tab-pane fade" id="flashcards" role="tabpanel">
                    <div class="text-center">
                        <div class="mb-4">
                            <span id="flashcardCounter" class="badge bg-secondary">0/0</span>
                        </div>
                        
                        <div class="flashcard-container mb-4">
                            <div class="flashcard" id="flashcard">
                                <div class="flashcard-front">
                                    <div class="flashcard-content" id="flashcardFront"></div>
                                </div>
                                <div class="flashcard-back">
                                    <div class="flashcard-content" id="flashcardBack"></div>
                                </div>
                            </div>
                        </div>

                        <div class="d-flex justify-content-center gap-2 mb-3">
                            <button class="btn btn-outline-primary" id="prevCardBtn" disabled>Previous</button>
                            <button class="btn btn-primary" id="flipCardBtn">Flip</button>
                            <button class="btn btn-outline-primary" id="nextCardBtn">Next</button>
                        </div>

                        <div class="d-flex justify-content-center gap-2 mb-4">
                            <button class="btn btn-success" id="markKnownBtn">Mark Known</button>
                            <button class="btn btn-danger" id="markUnknownBtn">Mark Unknown</button>
                        </div>
                    </div>
                </div>

                <!-- Quiz Tab -->
                <div class="tab-pane fade" id="quiz" role="tabpanel">
                    <div id="quizStart" class="text-center mb-4">
                        <h4>Ready to test your knowledge?</h4>
                        <p class="text-muted mb-4" id="quizQuestionsCount">0 questions</p>
                        <button class="btn btn-primary btn-lg" id="startQuizBtn">Start Quiz</button>
                    </div>

                    <div id="quizActive" style="display: none;">
                        <div class="card mb-4">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5 class="mb-0" id="quizQuestionNumber">Question 1</h5>
                                <span class="badge bg-secondary" id="quizProgress">1/0</span>
                            </div>
                            <div class="card-body">
                                <h6 class="card-title mb-3" id="quizQuestionText"></h6>
                                <div id="quizChoices" class="list-group">
                                    <!-- Choices will be populated here -->
                                </div>
                                <div id="quizFeedback" class="mt-3" style="display: none;">
                                    <div class="alert" id="feedbackAlert">
                                        <strong id="feedbackText"></strong>
                                        <div id="feedbackExplanation" class="mt-2"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="quizResults" style="display: none;">
                        <div class="card text-center mb-4">
                            <div class="card-body">
                                <h4 class="card-title">Quiz Complete!</h4>
                                <div class=" display-4 mb-3" id="quizScore">0%</div>
                                <p id="quizMessage" class="text-muted"></p>
                                <button class="btn btn-primary" id="restartQuizBtn">Try Again</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="noCapsuleSelected" class="text-center py-5">
            <h3 class="text-muted">Select a capsule to start learning</h3>
            <p class="text-muted">Choose from your library or create a new one</p>
        </div>
    </section>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- module JS -->
    <script type="module" src="js/storage.js"></script>
    <script type="module" src="js/main.js"></script>
    <script type="module" src="js/library.js"></script>
    <script type="module" src="js/author.js"></script>
    <script type="module" src="js/learn.js"></script>
</body>
</html>